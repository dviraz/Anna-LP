<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>רכב חדש - קבוצת מאיר</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🚗</text></svg>">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: A single-column, conversion-focused layout was chosen to minimize distractions and guide the user directly to the primary goal: form submission. The structure is a simple card containing a headline, a sub-headline, and the form itself. This direct approach is optimal for a lead generation landing page, ensuring the highest possible completion rate by providing a clear and simple user flow. -->
    <!-- Visualization & Content Choices: Report Info: Lead capture form -> Goal: Collect user data for CRM -> Presentation: Standard HTML form styled with Tailwind -> Interaction: Real-time vanilla JS validation for all fields (name, email, Israeli phone, branch selection). A hidden input field captures a 'sid' parameter from the URL for source tracking. -> Justification: This is the most direct and effective method for lead capture. No data visualization is needed. The hidden field allows for seamless CRM integration without cluttering the user interface. -> Library/Method: Vanilla JS, Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Assistant', sans-serif;
        }
        .form-input-focus:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            --tw-ring-color: #4f46e5;
            --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
            --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
            box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
        }
    </style>
</head>
<body class="bg-gray-50">

    <div class="min-h-screen flex flex-col items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
        <div id="form-container" class="w-full max-w-lg space-y-8 p-8 md:p-10 bg-white rounded-xl shadow-lg">
            <div>
                <h1 class="text-center text-3xl md:text-4xl font-bold text-gray-900">
                    תתחדשו על הרכב החדש!
                </h1>
                <p class="mt-2 text-center text-md text-gray-600">
                    כדי שנוכל להשלים את תהליך הרישום, אנא מלאו את הפרטים הבאים:
                </p>
            </div>
            
            <form id="lead-form" class="mt-8 space-y-6" action="#" method="POST" novalidate>
                <input type="hidden" id="source_id" name="source_id" value="">

                <div class="rounded-md shadow-sm -space-y-px">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="first-name" class="block text-sm font-medium text-gray-700 mb-1">שם פרטי</label>
                            <input id="first-name" name="first-name" type="text" required class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm form-input-focus" placeholder="לדוגמה: ישראל">
                            <p id="first-name-error" class="text-red-500 text-xs mt-1 min-h-0"></p>
                        </div>
                        <div>
                            <label for="last-name" class="block text-sm font-medium text-gray-700 mb-1">שם משפחה</label>
                            <input id="last-name" name="last-name" type="text" required class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm form-input-focus" placeholder="לדוגמה: ישראלי">
                             <p id="last-name-error" class="text-red-500 text-xs mt-1 min-h-0"></p>
                        </div>
                    </div>
                     <div>
                        <label for="email-address" class="block text-sm font-medium text-gray-700 mb-1">כתובת אימייל</label>
                        <input id="email-address" name="email" type="email" autocomplete="email" required class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm form-input-focus" placeholder="mail@example.com">
                        <p id="email-error" class="text-red-500 text-xs mt-1 min-h-0"></p>
                    </div>
                     <div class="pt-4">
                        <label for="phone-number" class="block text-sm font-medium text-gray-700 mb-1">מספר טלפון</label>
                        <input id="phone-number" name="phone" type="tel" autocomplete="tel" required class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm form-input-focus" placeholder="05X-XXXXXXX">
                        <p id="phone-error" class="text-red-500 text-xs mt-1 min-h-0"></p>
                    </div>
                     <div class="pt-4">
                        <label for="branch-selection" class="block text-sm font-medium text-gray-700 mb-1">בחירת סניף</label>
                        <select id="branch-selection" name="branch" required class="appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 bg-white text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm form-input-focus">
                            <option value="" disabled selected>יש לבחור סניף מהרשימה</option>
                            <option value="באר שבע">באר שבע</option>
                            <option value="אשדוד">אשדוד</option>
                            <option value="חיפה">חיפה</option>
                            <option value="קרית עקרון">קרית עקרון</option>
                            <option value="רמת השרון">רמת השרון</option>
                            <option value="טבריה">טבריה</option>
                            <option value="נס ציונה">נס ציונה</option>
                            <option value="ירושלים">ירושלים</option>
                            <option value="נתניה">נתניה</option>
                            <option value="עפולה">עפולה</option>
                            <option value="קיבוץ עין המפרץ">קיבוץ עין המפרץ</option>
                            <option value="ראש העין">ראש העין</option>
                            <option value="רעננה">רעננה</option>
                        </select>
                        <p id="branch-error" class="text-red-500 text-xs mt-1 min-h-0"></p>
                    </div>
                </div>

                <div class="pt-6">
                    <button id="submit-button" type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-bold rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-opacity duration-300 opacity-50 cursor-not-allowed">
                        שלח פרטים
                    </button>
                </div>
            </form>
        </div>

        <div id="success-message" class="w-full max-w-lg text-center hidden">
             <div class="p-10 bg-white rounded-xl shadow-lg">
                <svg class="mx-auto h-12 w-12 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h2 class="mt-4 text-2xl font-bold text-gray-900">תודה שבחרתם בקבוצת מאיר</h2>
                 <div class="mt-8 flex justify-center items-center gap-6">
                    <img src="meir.png" alt="לוגו קבוצת מאיר" class="h-10 w-auto">
                    <img src="autocenter.png" alt="לוגו אוטוסנטר" class="h-16 w-auto">
                    <img src="klslogo_white_text.png" alt="לוגו KLS" class="h-12 w-auto">
                </div>
             </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('lead-form');
            const firstNameInput = document.getElementById('first-name');
            const lastNameInput = document.getElementById('last-name');
            const emailInput = document.getElementById('email-address');
            const phoneInput = document.getElementById('phone-number');
            const branchInput = document.getElementById('branch-selection');
            const submitButton = document.getElementById('submit-button');
            const hiddenSourceIdInput = document.getElementById('source_id');

            const errorMessages = {
                firstName: document.getElementById('first-name-error'),
                lastName: document.getElementById('last-name-error'),
                email: document.getElementById('email-error'),
                phone: document.getElementById('phone-error'),
                branch: document.getElementById('branch-error'),
            };

            const validators = {
                firstName: (value) => value.trim() !== '',
                lastName: (value) => value.trim() !== '',
                email: (value) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value),
                phone: (value) => /^0\d{1,2}-?\d{7}$/.test(value),
                branch: (value) => value !== '',
            };

            const errorTexts = {
                firstName: 'יש להזין שם פרטי.',
                lastName: 'יש להזין שם משפחה.',
                email: 'כתובת האימייל אינה תקינה.',
                phone: 'מספר הטלפון אינו תקין (לדוגמה: 052-1234567).',
                branch: 'יש לבחור סניף מהרשימה.',
            };

            function setSourceId() {
                const urlParams = new URLSearchParams(window.location.search);
                const sid = urlParams.get('sid');
                hiddenSourceIdInput.value = sid || 'Direct';
            }

            function validateField(input, validator, errorMsgElement, errorText) {
                const isValid = validator(input.value);
                
                // Only show error messages if the field has been touched (user has interacted with it)
                if (input.dataset.touched === 'true') {
                    errorMsgElement.textContent = isValid ? '' : errorText;
                    if (isValid) {
                        input.classList.remove('border-red-500');
                        input.classList.add('border-gray-300');
                    } else {
                        input.classList.add('border-red-500');
                        input.classList.remove('border-gray-300');
                    }
                } else {
                    // Field hasn't been touched yet, don't show errors
                    errorMsgElement.textContent = '';
                    input.classList.remove('border-red-500');
                    input.classList.add('border-gray-300');
                }
                
                return isValid;
            }

            function validateForm() {
                const isFirstNameValid = validateField(firstNameInput, validators.firstName, errorMessages.firstName, errorTexts.firstName);
                const isLastNameValid = validateField(lastNameInput, validators.lastName, errorMessages.lastName, errorTexts.lastName);
                const isEmailValid = validateField(emailInput, validators.email, errorMessages.email, errorTexts.email);
                const isPhoneValid = validateField(phoneInput, validators.phone, errorMessages.phone, errorTexts.phone);
                const isBranchValid = validateField(branchInput, validators.branch, errorMessages.branch, errorTexts.branch);

                const isFormValid = isFirstNameValid && isLastNameValid && isEmailValid && isPhoneValid && isBranchValid;

                if (isFormValid) {
                    submitButton.disabled = false;
                    submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    submitButton.disabled = true;
                    submitButton.classList.add('opacity-50', 'cursor-not-allowed');
                }
                return isFormValid;
            }
            
            [firstNameInput, lastNameInput, emailInput, phoneInput, branchInput].forEach(input => {
                input.addEventListener('input', validateForm);
                
                // Mark field as touched when user starts typing or selects
                input.addEventListener('blur', () => {
                    input.dataset.touched = 'true';
                    validateForm();
                });
                
                input.addEventListener('input', () => {
                    input.dataset.touched = 'true';
                });
            });

            form.addEventListener('submit', (event) => {
                event.preventDefault();
                
                // Mark all fields as touched when form is submitted
                [firstNameInput, lastNameInput, emailInput, phoneInput, branchInput].forEach(input => {
                    input.dataset.touched = 'true';
                });
                
                const isFormValid = validateForm();
                
                if (isFormValid) {
                    submitButton.textContent = 'שולח...';
                    submitButton.disabled = true;

                    // ...existing code...
                    setTimeout(() => {
                        document.getElementById('form-container').classList.add('hidden');
                        document.getElementById('success-message').classList.remove('hidden');
                    }, 1000);
                }
            });

            setSourceId();
            validateForm(); 
        });
    </script>
</body>
</html>
